# Adobe Illustrator Scripts

アップデート情報（新規／アップデート）は、noteが一番早いです。

[DTP Transit 別館｜note](https://note.com/dtp_tranist)

- 公開後、日々の作業で使う中でバグフィックや調整を行っています。
- 「うまくいかなかった」「こうなるといい」などがあればフィードバックくださいますと助かります。その際、対象となるドキュメントを添えてくださいますと検証しやすいです（いただいたアートワークは外部には公開しません）。

[DTP Transitで公開しているスクリプトについて｜DTP Transit 別館](https://note.com/dtp_tranist/n/n60092f59a341)

[TOC]


### カラー

### スウォッチの連続適用

選択中のオブジェクトに対して、スウォッチパネルで選択されているスウォッチを順に適用します。

UIはありません。

https://github.com/swwwitch/illustrator-scripts/blob/master/jsx/ApplySwatchesToSelection.jsx

### カラーをランダム適用

![](https://github.com/swwwitch/illustrator-scripts/blob/master/png/ss-490-440-72-20250624-213948.png)

https://github.com/swwwitch/illustrator-scripts/blob/master/jsx/ShuffleObjectColors.jsx

## ドキュメント

### ドキュメントの切替

- 開いているドキュメント数が**1つ**なら、何も起きない
- 開いているドキュメント数が**2つ**なら、ダイアログボックスを表示せず、アクティブでないドキュメントに切り換える
- 開いているドキュメント数が**3つ**以上なら、ダイアログボックスでドキュメントを切り換える（ただし、現在のアクティブなドキュメントは別扱いにする）

![ss-708-712-72-20250601-085759](https://github.com/user-attachments/assets/e2e98c44-0db3-46c6-9f0e-579b17b82599)


[【Illustrator】ドキュメント切替をスムーズに行うスクリプト｜DTP Transit 別館](https://note.com/dtp_tranist/n/nd9c7b7c077fb)

---

## 配置や整列

### グリッド状にガイドを生成

https://youtu.be/7sNMYhyTwfY


- 行数・列数の指定による分割数
- 上・下・左・右マージンの個別指定
- 共通マージン入力欄とチェックボックス（有効時は上下左右マージンを一括適用）
- アートボード外への延長距離
- 対象を「アクティブなアートボードのみに適用」または「すべてのアートボードに適用」の選択
- プリセットからの設定読み込み（行列数・マージン・延長距離）

また、次のようになっています。

- ［適用］ボタンをクリックすると、現在の設定に応じたガイドプレビューが表示される
- ［すべて同じにする］チェックボックスは、上下左右のマージンが一致しない場合に自動でOFFになる
- OKを押すと「ガイドをロック」状態に設定される

### 標準ツールでなく、このスクリプトを使うメリット

- アートボードを対象にする場合、アートボードサイズの長方形を描く手間が省ける
- すべてのアートボードを対象にできる
- アートボードに対して上下左右、個別にマージンを設定できる
- アートボードからどれだけ伸ばすか、指定できる

#### 段組設定との違い

スクリプトの方は次のような特徴があります。

- アートボードが対象（段組設定はパスが対象）
- ガイドの長さを調整できる（段組設定はガイドが長い）
- 上下左右のマージンを個別に設定できる
- プリセットを登録できる
- 生成される長方形が別レイヤーに、不透明度を15%に設定

---

### 複数のオブジェクトの大きさを最大（最小）の幅や高さに合わせる

- ラジオボタンでリサイズ基準を選択
    - 最大：幅／高さ
    - 最小：幅／高さ
    - 基準：長辺／短辺
    - アートボード／幅／高さ
- 幅指定／高さ指定の場合には値を入力（単位は環境設定に依存）
    - デフォルトは最大の幅
- オープンパスの直線の場合、最小の幅や高さからは除外
- 選択肢を切り替えるたびに即時リサイズ（ドキュメント上のオブジェクトに反映）
- ［キャンセル］ボタンで元のサイズ・位置に復元
- ［プレビュー境界］のON/OFFを追加
- 整列機能を追加

[【Illustrator】複数のオブジェクトの大きさを最大（最小）の幅や高さに合わせる｜DTP Transit 別館](https://note.com/dtp_tranist/n/n3e4e38c48d39)

片辺だけの変形に対応しました。

[【Illustrator】複数のオブジェクトの大きさをリサイズするスクリプト（updated）｜DTP Transit 別館](https://note.com/dtp_tranist/n/n6f35bd4000ec)


### 配置したオブジェクトをグリッド状に配置する

![ss-2006-988-72-20250520-163549](https://github.com/user-attachments/assets/b438fa19-3d35-4b65-9ebc-c5de37946511)


- 行数・列数、上下左右マージン、行間／列間の個別設定
- マージンを「すべて同じ値にする」で一括指定可能
- セルに不透明度付きの長方形を描画（黒・白・透過を選択）
- 「残す」「ガイド化」「アートボード化」オプション付きで長方形制御
- 選択オブジェクトを各セルに順次配置（余りは無視し、元の位置に）
- 「ランダム」ボタンで配置順をシャッフル

![ss-746-988-72-20250521-053754](https://github.com/user-attachments/assets/3bec4d25-184d-46ab-98c5-fecbb2be9c0d)


[【Illustrator】配置したオブジェクトをグリッド状に配置するスクリプト｜DTP Transit 別館](https://note.com/dtp_tranist/n/na3c45cea09b7)

### 選択したオブジェクトを幅や高さ、不透明度、カラーでソート

![ss-1854-1192-72-20250602-073752](https://github.com/user-attachments/assets/a7e71b0b-6720-4747-a141-511226d1896f)


- 並び方向：「横並び」または「縦並び」
    
    選択オブジェクトの配置に応じて自動判定され、初期選択に反映される
    
- 並び順：「小さい順」「大きい順」「ランダム」
    
    対象属性（高さ・幅など）を元に昇順／降順に並べる
    
- 配置間隔：「均等に再配置する」または「元の間隔を保持する」
    
    配置の密度を調整するためのオプション
    
- 整列方向：選択した基準に応じて「左」「右」「上」「下」を指定可能
    
    使用できない整列方向は自動的に無効化される
    
![ss-562-720-72-20250602-073450](https://github.com/user-attachments/assets/7eb7dab5-fdf4-45c4-94d4-ecc33cde8277)

[【Illustrator】選択したオブジェクトを幅や高さ、不透明度、カラーでソートするスクリプト｜DTP Transit 別館](https://note.com/dtp_tranist/n/n663264db75ff)

## オブジェクトを入れ替え

- 選択中のオブジェクトと、指定方向（上下左右）にある最も近いオブジェクトの位置を入れ替える
- ダイアログボックスを表示中、↑↓キーで上下、←→キーで左右のオブジェクトを入れ替える

https://github.com/swwwitch/illustrator-scripts/blob/master/jsx/SwapNearestItemWithDialogbox.jsx

![](https://github.com/swwwitch/illustrator-scripts/blob/62637fb44f3091ec94b5c4b48094221be9e07686/png/ss-294-226-72-20250627-000819.png)

---

## フォント関連

### 選択したテキストのフォント名、フォントサイズなどをテキストとして生成する

https://youtu.be/8ClvEwyFoAw

![ss-446-742-72-20250430-182416](https://github.com/user-attachments/assets/cec5ce38-37d4-4248-bd61-9daec334a213)

- 表示形式は「詳細表示」と「簡易表示」から選択可能
- 詳細表示はエリア内文字、簡易版はポイント文字で出力される
- 詳細表示のとき、表示内容はチェックボックスでカスタマイズ可能。
    
    「すべてON/OFF」ボタン、「最小セット」ボタンで切り換え
    

次の情報を拾えます。

- フォント名 *
- PSフォント名
- スタイル（ウエイト） *
- フォントサイズ *
- 行送り *
- カーニング *
- プロポーショナルメトリクス *
- トラッキング *
- 文字ツメ *

簡易版のときには「 *」が対象です。

[【Illustrator】選択したテキストのフォント名、フォントサイズなどをテキストとして生成する｜DTP Transit 別館](https://note.com/dtp_tranist/n/n607ef418877f)

## ドキュメントフォント関連

### フォント置換

- フォントをファミリー／スタイルごとに整理して表示
    
    （スタイル1つのみのファミリーは分類しない）
    
- 複数のフォントスタイルを選択して、1つのフォントスタイルに一括置換
- ファミリー行をクリックすると、属する全スタイルが自動選択される（置換元のみ）
- ファミリー名行（見出し）は置換先リストでは選択不可
- 「全置換」ボタンで、使用中すべてのフォントを一括で選択されたフォントに置換可能。置換先未選択でも、置換元を選択していれば、その1つ目のフォントに全フォントを置換可能
- 置換後にプレビューを即時更新

[【Illustrator】「使われているフォント」だけを、速く・正確に扱うために活用したいドキュメントフォント｜DTP Transit 別館](https://note.com/dtp_tranist/n/n01d6ef7e9b5f)

![ss-1248-692-72-20250430-182640.png](attachment:302f894e-c43d-4ff4-91d9-b11a181f70be:ss-1248-692-72-20250430-182640.png)

［書き出し］ボタンを付けました。

![ss-880-632-72-20250501-150629.png](attachment:d3249346-5eec-41b0-9681-a4c880680463:ss-880-632-72-20250501-150629.png)
![ss-880-632-72-20250501-150629](https://github.com/user-attachments/assets/020427ab-c5e5-4e1f-b490-f0cfb396c378)

- ドキュメント内で使用されているフォントの一覧を取得し、使用数順に並べてダイアログボックスに表示
- フォント数をカウントし、（）内に表示
- 検索フィルターで絞り込みが可能（PostScript名でも参照可）
- Illustratorのドキュメントで使用されているフォントをリストアップし、選択しているテキストに適用できます。
- リストボックスで↑↓キーやクリックでフォントを選択すると、ドキュメントで選択中のテキストに即時反映される
- ［書き出し］ボタンをクリックすると、デスクトップにテキストファイルで書き出します。

#### 標準ツールでなく、このスクリプトを使うメリット

- フォントのみを適用できる（スポイトなどフォント以外の情報も参照するため）
- テキスト書き出し：Illustrator 2025（29）以降、文字化けするため

[【Illustrator】ドキュメントフォント一覧をテキストファイルで書き出す｜DTP Transit 別館](https://note.com/dtp_tranist/n/neaae531e4281)

グループに対応

https://github.com/swwwitch/illustrator-scripts/blob/master/jsx/ApplyDocumentFonts.jsx

---

### カテゴリ別ウエイト順にフォントを一覧表示し、フォント見本を一瞬で作成する

次のようなフォント見本を作成します。

![ss-2056-1442-72-20250505-122116.png](attachment:87d61db3-e825-4e24-8d80-68977c765c63:ss-2056-1442-72-20250505-122116.png)

![ss-776-958-72-20250506-203117.png](attachment:a8e642fa-f75a-49f1-9154-7672327ec3e7:ss-776-958-72-20250506-203117.png)

- 先頭に1〜2桁の数値がある場合はそれを最優先
- キーワード表に基づいて加点
- italic、Oblique、Condensedは別扱い（"Italic", "Oblique" → +500、"Condensed" → +1000 として別途加算）

[【Illustrator】カテゴリ別ウエイト順にフォントを一覧表示し、フォント見本を一瞬で作成するスクリプト｜DTP Transit 別館](https://note.com/dtp_tranist/n/n103ac6622657)


---

### ドキュメントで使用されているフォント情報を書き出す

アクティブなIllustratorドキュメントに埋め込まれているXMPメタデータからすべてのフォント情報を抽出し、次のファイル形式でデスクトップに保存します。

- テキストファイル（タブ区切り）
- CSV
- Markdown

![ss-476-456-72-20250510-182221.png](attachment:3a82abb8-4f66-44c3-adbb-dc137f9b5963:ss-476-456-72-20250510-182221.png)

![ss-3022-1094-72-20250511-174806.png](attachment:8d78cf2e-cd72-4db0-aa2b-a8c3105dcc4d:ss-3022-1094-72-20250511-174806.png)

![フォント情報を抜き出し.png](attachment:75a2406c-1a46-4c50-b31d-63488ba94371:フォント情報を抜き出し.png)

合成フォントの構成フォントも取り出せます。

```markdown
### sw-B

- fontName: ATC-73772d42
- fontFace: 
- fontType: 合成フォント
- composite: True
- fileName: sw-B

#### 構成フォント
- RyoGothicStd-Bold.otf
- NotoSansCJKjp-Light.otf
- ヒラギノ角ゴシック W2.ttc
- RyoGothicStd-Heavy.otf
```

テキストファイル

```xml
fontName:	ATC-73772d42
fontFamily:	sw-B
fontFace:	
fontType:	合成フォント
composite:	True
fileName:	sw-B
構成フォント:
・RyoGothicStd-Bold.otf
・NotoSansCJKjp-Light.otf
・ヒラギノ角ゴシック W2.ttc
・RyoGothicStd-Heavy.otf
・RyoGothicStd-Bold.otf
```

[【Illustrator】ドキュメントで使用されているフォント情報を書き出す｜DTP Transit 別館](https://note.com/dtp_tranist/n/n16e7e95652b6)

---

## テキスト関連

### 文字ばらし

![ss-2436-1240-72-20250609-170356.png](attachment:09fec99a-b12c-4b2b-affa-3e4ff8ab5b76:ss-2436-1240-72-20250609-170356.png)

[【Illustrator】テキストを1文字ごとにバラバラにしたい｜DTP Transit 別館](https://note.com/dtp_tranist/n/n26b329ff743e)


## 基本図形

### 正方形や正円、正三角形を作成するスクリプト

https://youtu.be/EoUUIdbC0IU

![ss-736-858-72-20250503-091001.png](attachment:84747a07-6926-4911-aeeb-46f421cccc87:ss-736-858-72-20250503-091001.png)

- ダイアログボックスで、［辺の数］、［幅］を指定できます。
- 図形はリアルタイムでプレビュー表示され、OKを押すと確定して描かれます。
- 辺の数はラジオボタンで選択、または手動入力できます。
- 正多角形の底辺が水平になるように回転角を自動設定。（360 ÷ 辺の数 ÷ 2）※自分で入力も可能（正円のときには45°）
- 現在の〈塗り〉を参照します。線のカラーや線幅は無視します。
- Illustratorのドキュメントウインドウの中央に描画します。
- 幅でサイズを指定（第1半径は削除）
- スターON時のみ第2半径（比率％）が有効
- ［五芒星］オプションをONにすると、辺数を5に設定し、5本の線分で構成されるように角度を調整します。
- ［ライブシェイプ］オプションをONにすると、ライブシェイプとして描画します。

### 標準ツールでなく、このスクリプトを使うメリット

- 4つのツールを使い分ける必要がなくなる
- 正多角形の辺の数に応じて、自動的に回転するオプションを使える
- スピンボタンでなく、ラジオボタンで選べる
- ［OK］ボタンを押す前にプレビューが見える（特に［スターツール］）
- 辺数：5で、5本の線分で構成されるように角度を自動調整する［五芒星］オプションを使える
- 星形の第2半径は、長さでなく、%で指定できる
    
    （第1半径＝幅です）
    

[【Illustrator】正方形や正円、正三角形を作成するスクリプト｜DTP Transit 別館](https://note.com/dtp_tranist/n/n47cb6051e206)


---

### アートワークやファイル

### 選択したオブジェクトを書き出すスクリプト

選択したオブジェクトを一時アートボードに収めて PNG 書き出しするスクリプトです。
書き出し倍率・余白・背景・罫線・ファイル名・保存先などを UI で柔軟に設定でき、プレビュー機能によりリアルタイムで結果を確認できます。

- 選択オブジェクトを囲む一時アートボードを生成し、そこから PNG 書き出し
- 背景は透過／白／黒／任意カラー、透明グリッドから選択可能
- 書き出し倍率（1x/2x/3x/4x/カスタム%）または幅(px)指定が可能
- 余白と罫線の有無・サイズ・色を設定でき、単位に応じて自動換算
- ファイル名は接尾辞＋記号（-／_）の組み合わせで動的に構成
- 禁則文字（¥ / : * ? " < > | スペース類）は選択記号に自動置換
- 書き出し先はデスクトップ／元ファイルと同じ場所を選択可能
- 書き出し後、自動的に Finder/Explorer で保存フォルダを開く
- プリセットの保存・読み込み機能あり（倍率、背景、余白、接尾辞などを記憶）
- ロックされたオブジェクトや非表示レイヤーも適切に処理
- 書き出し対象外のオブジェクトは一時的に非表示にして安全に処理
- 書き出し位置・サイズはピクセルパーフェクトに調整（XYWH を整数化）
- ファイル名を参照する／しないを設定できるようにしました。

![ss-1244-1296-72-20250518-233739.png](attachment:76e0b849-5888-4c99-aafd-0988beb38ea8:ss-1244-1296-72-20250518-233739.png)

[【Illustrator】選択したオブジェクトを書き出すスクリプト｜DTP Transit 別館](https://note.com/dtp_tranist/n/necf308c39f5d)


---

### 開いているファイルを1つに整列統合するIllustratorスクリプト

- 複数の AI/SVG ファイルをバッチ処理で読み込み、表示中かつロック解除されているオブジェクトを対象に
- ファイルが開いているときには、そのファイルが対象。
    
    そうでない場合には、読み込みフォルダーを指定
    
- 新規ドキュメントに貼り付け、グループ化してアートボード内に自動整列します。
- 各グループにはオプションでファイル名ラベルを追加可能
    
    （拡張子の表示有無も指定）
    
- 読み込み後のドキュメントを閉じる／閉じないを指定可能

[【Illustrator】開いているファイルを1つに整列統合するIllustratorスクリプト｜DTP Transit 別館](https://note.com/dtp_tranist/n/n8180588e5630)


### Figmaの⌘ + shift + C（ビットマップとしてコピー）

![ss-460-450-72-20250603-092734.png](attachment:ae88cae3-2f8b-4b93-8098-efbccce05b3f:ss-460-450-72-20250603-092734.png)

[【Illustrator】Figmaの⌘ + shift + C（ビットマップとしてコピー）をIllustratorでも｜DTP Transit 別館](https://note.com/dtp_tranist/n/nf5f269788086)


---

## アートボード

### アートボード名を最前面のテキストや特定のレイヤーのテキストに設定するスクリプト

アートボード名を最前面のテキストや特定のレイヤーのテキストに設定します。

- 「最前面のテキスト」または「レイヤー指定」を選択
- 「最前面のテキスト」選択時は、アートボードごとに最も上にあるテキストフレーム（Z順で前面）を1つ参照
- 「レイヤー指定」時は、全レイヤーから選択可能なポップアップを表示
    - 複数のテキストがある場合には、見た目の上から順（Z順）に結合
- 同名が重複する場合は自動で "_2", "_3" を付加して回避
- #FN：ファイル名
- #DT：タイムスタンプ（yyyyMMdd）

![ss-1076-614-72-20250511-025146.png](attachment:c8427862-e33a-40bf-82b3-6bbae6532097:ss-1076-614-72-20250511-025146.png)

[【Illustrator】アートボード名を最前面のテキストや特定のレイヤーのテキストに設定するスクリプト｜DTP Transit 別館](https://note.com/dtp_tranist/n/ne0934ee22972)

### ページ番号を挿入

https://github.com/swwwitch/illustrator-scripts/blob/9606b06755b8ddb24f229bd09e5a5828c39b6c1d/jsx/AddPageNumberFromTextSelection.jsx

![](png/ss-664-440-72-20250627-114603.png)


---

## アートボード名の一括変更

![ss-1210-1120-72-20250430-180043.png](attachment:2ea8fd8f-2284-4612-bca6-0adb4bdb4f3f:ss-1210-1120-72-20250430-180043.png)

- 接頭辞・接尾辞・元のアートボード名の有無を指定可能
- 連番は「数字」「アルファベット（大文字／小文字）」に対応
- 連番形式を選択すると、開始番号を自動入力（例：A/a）
- 「ファイル名の参照」や「区切り文字」など柔軟な命名に対応
- プレビュー機能により変更内容を事前確認可能
- OK／適用／キャンセルボタンを左右に美しく配置
- ［桁数（数字）］を削除。［開始番号］の値を参照して桁数を設定
- プリセットを書き出せる

[【Illustrator】連番や指定文字を使ってアートボード名前を一括変更｜DTP Transit 別館](https://note.com/dtp_tranist/n/n80f9534bc6fb)


## マスク

## オブジェクトのまとまりごとにグループ化したり、マスクする

対象のオブジェクトが少ない場合には、地道にグループ化したり、マスクすればいいのですが、数が増えたら絶望的です。

オブジェクトのまとまりごとにグループ化したり、マスクするスクリプトを作ってみました。

![image.png](attachment:270acdaa-b7f2-4b23-abb2-e0c86f7c113c:image.png)

[【Illustrator】オブジェクトのまとまりごとにグループ化したり、マスクする｜DTP Transit 別館](https://note.com/dtp_tranist/n/nb23985473f80)


### 〈クリッピングマスクを解除〉を拡張するスクリプト

Illustratorのデフォルトの〈クリッピングマスクを解除〉機能を実行すると、パスと対象となるオブジェクト（リンクファイル）が残ります。

![image.png](attachment:f8dec052-27f6-455f-8ee8-ef445304cedd:image.png)

制作フローによっては、次のような処理が必要になることがあります。

- マスクの図形のみを残す
- パスのみを残す

〈クリッピングマスクを解除〉の3つのフローをダイアログボックスで引き受けるスクリプトを準備しました。

![image.png](attachment:a609360f-1320-4327-bb73-d9fac4093324:image.png)

[【Illustrator】〈クリッピングマスクを解除〉を拡張するスクリプト｜DTP Transit 別館](https://note.com/dtp_tranist/n/nebc832e574f7)


## パズル

- 選択している配置画像の形状、ピース数から、各ピースがおおよそ正方形になるように列数／行数を自動計算
- 「バラけ」処理の強さを数値指定できるように
- 選択している配置画像を、それぞれのピースでマスク
- シンボルを対象にしました。埋め込み画像はシンボルに変換されます。ベクターアートワークもシンボルに変換されます。

![ss-2170-1832-72-20250609-053640.png](attachment:5a41b416-bf8e-40b3-80b9-65253408c7b4:ss-2170-1832-72-20250609-053640.png)

https://www.youtube.com/watch?v=6PSJE333slQ

[【Illustrator】画像だけを選択して、パズルのピース作成からマスクまでを一括で行うスクリプト｜DTP Transit 別館](https://note.com/dtp_tranist/n/n89f63325c0bc?magazine_key=mebd7eab21ea5)


### その他

### トンボ作成

アートボードまたは選択オブジェクトに対してトリムマークを作成し、「トンボ」レイヤーに配置してロックします。あわせて対象オブジェクトを複製し、ガイドに変換します。

[【Illustrator】塗り足し部分を隠すオブジェクト作成をスクプトを使って1ステップで準備する（Illustratorのアクション、スクリプト）｜DTP Transit 別館](https://note.com/dtp_tranist/n/n602696048b72)

